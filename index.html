<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Internalytics — Recruiting, decoded.</title>
  <link rel="stylesheet" href="main.css" />
  <meta name="description" content="Analyze internship cycles, uncover timing patterns, and act with insight. Internalytics focuses on insight over listings." />
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="container inner">
      <a href="index.html" class="row" style="gap:.6rem;text-decoration:none">
        <img src="images/logo.png" alt="Internalytics mark" width="28" height="28" style="border-radius:6px;box-shadow:var(--shadow-sm)" />
        <strong style="color:var(--text-strong)">Internalytics</strong>
      </a>
      <nav class="nav" aria-label="Primary">
        <a href="radar.html">Opportunity Radar</a>
        <a href="cycle.html">Cycle Intelligence</a>
        <a href="playbooks.html">Playbooks</a>
        <a href="networking.html">Networking Hub</a>
        <a href="tracker.html">Tracker</a>
        <a href="about.html">About</a>
        <a class="cta" href="account.html">Sign in</a>
      </nav>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero">
    <div class="container content">
      <div class="row" style="gap:1rem;align-items:center">
        <img src="images/logo.png" alt="Internalytics logo" width="64" height="64" style="border-radius:16px;box-shadow:var(--shadow-md)" />
        <div>
          <h1>Recruiting, decoded.</h1>
          <p>Analyze internship cycles, uncover timing patterns, and act with insight across Finance, Accounting, Consulting, and Real Estate.</p>
        </div>
      </div>
      <div class="actions">
        <a class="btn" href="#cycle-intelligence">See Timeline</a>
        <a class="btn secondary" href="radar.html">Explore Radar</a>
        <a class="btn ghost" href="account.html">Sign in</a>
      </div>
    </div>
  </section>

  <!-- Snapshot Analytics Bar -->
  <section class="section">
    <div class="container">
      <div class="analytics-bar" role="region" aria-label="Snapshot KPIs">
        <div class="kpi">
          <div class="value" id="kpi-open">42</div>
          <div class="label">Open applications now</div>
        </div>
        <div class="kpi">
          <div class="value" id="kpi-interview">18</div>
          <div class="label">Interview windows active</div>
        </div>
        <div class="kpi">
          <div class="value" id="kpi-offer">6</div>
          <div class="label">Offer waves this week</div>
        </div>
        <div class="kpi">
          <div class="value" id="kpi-updated">Today</div>
          <div class="label">Last data refresh</div>
        </div>
      </div>
    </div>
  </section>

 <!-- Cycle Intelligence Interactive Calendar (Swipe-enabled) -->
<section id="cycle-intelligence" class="section headroom">
  <div class="container">
    <div class="row" style="justify-content:space-between;align-items:center;">
      <h2 class="m-0">Cycle Intelligence — Calendar</h2>
      <div>
        <button id="prevBtn" class="btn ghost small">←</button>
        <button id="nextBtn" class="btn ghost small">→</button>
      </div>
    </div>
    <p class="caption mt-2">View internship cycles across disciplines, five months at a time. Swipe to navigate on mobile.</p>

    <div class="calendar-wrapper mt-4" id="calendarWrapper">
      <div class="calendar-grid" id="calendarGrid">
        <!-- Calendar dynamically rendered -->
      </div>
    </div>
  </div>
</section>

<style>
.calendar-wrapper {
  overflow-x: auto;
  position: relative;
  border: 1px solid var(--border-color, #ddd);
  border-radius: 12px;
  padding-bottom: 10px;
  touch-action: pan-y;
}
.calendar-grid {
  display: grid;
  grid-template-rows: auto;
  position: relative;
  width: max-content;
  min-width: 100%;
  font-size: 0.85rem;
  user-select: none;
}
.calendar-month-header {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  text-align: center;
  font-weight: 600;
  background: var(--bg-subtle, #f7f7f7);
  padding: 0.5rem 0;
  border-bottom: 1px solid #ddd;
}
.calendar-row {
  display: grid;
  grid-template-columns: 150px repeat(5, 1fr);
  align-items: center;
  border-bottom: 1px solid #eee;
  position: relative;
}
.calendar-row .discipline {
  font-weight: 600;
  padding-left: 8px;
}
.calendar-cell {
  height: 40px;
  border-left: 1px solid #eee;
  position: relative;
}
.highlight {
  position: absolute;
  top: 4px;
  bottom: 4px;
  background: rgba(0, 200, 0, 0.25);
  border-radius: 4px;
}
.today-line {
  position: absolute;
  top: 0;
  bottom: 0;
  width: 2px;
  background: red;
  pointer-events: none;
}
</style>

<script>
const calendarGrid = document.getElementById("calendarGrid");
const calendarWrapper = document.getElementById("calendarWrapper");
let currentMonthOffset = 0;

const cycleRanges = [
  {
    discipline: "Finance",
    ranges: [{ start: "2025-09-01", end: "2025-11-15" }]
  },
  {
    discipline: "Accounting",
    ranges: [{ start: "2025-07-01", end: "2025-09-30" }]
  },
  {
    discipline: "Consulting",
    ranges: [{ start: "2025-08-15", end: "2025-10-31" }]
  },
  {
    discipline: "Real Estate",
    ranges: [{ start: "2025-09-10", end: "2025-12-05" }]
  }
];

const MONTH_NAMES = [
  "January", "February", "March", "April", "May", "June",
  "July", "August", "September", "October", "November", "December"
];

// Render the repeating 12-month loop centered on current month
function renderCalendar(offset = 0) {
  const now = new Date();
  const currentIndex = now.getMonth();
  const visibleCount = 5;
  const startIndex = (currentIndex + offset - 2 + 12) % 12;

  const months = [];
  for (let i = 0; i < visibleCount; i++) {
    months.push(MONTH_NAMES[(startIndex + i) % 12]);
  }

  // Reset grid
  calendarGrid.innerHTML = "";

  // Header row (no years)
  const header = document.createElement("div");
  header.className = "calendar-month-header";
  months.forEach(m => {
    const cell = document.createElement("div");
    cell.textContent = m;
    header.appendChild(cell);
  });
  calendarGrid.appendChild(header);

  // Base timeline (full year)
  const startOfYear = new Date(now.getFullYear(), 0, 1);
  const endOfYear = new Date(now.getFullYear(), 11, 31);
  const totalYearDays = (endOfYear - startOfYear);

  // Compute “today” relative to year progress
  const today = new Date();
  const todayRatio = (today - startOfYear) / totalYearDays;

  // Discipline rows
  cycleRanges.forEach(item => {
    const row = document.createElement("div");
    row.className = "calendar-row";
    const disciplineCell = document.createElement("div");
    disciplineCell.className = "discipline";
    disciplineCell.textContent = item.discipline;
    row.appendChild(disciplineCell);

    // 5 months of cells
    months.forEach(() => {
      const cell = document.createElement("div");
      cell.className = "calendar-cell";
      row.appendChild(cell);
    });

    // Highlights (projected onto the looping timeline)
    item.ranges.forEach(r => {
      const s = new Date(r.start);
      const e = new Date(r.end);
      const sRatio = (s - startOfYear) / totalYearDays;
      const eRatio = (e - startOfYear) / totalYearDays;
      const highlight = document.createElement("div");
      highlight.className = "highlight";

      // Map to our 5-month visual band (wrap if crossing December)
      let left = sRatio * 100;
      let width = (eRatio - sRatio) * 100;
      if (width < 0) width += 100; // wraparound correction
      highlight.style.left = `calc(${left}% + 150px)`;
      highlight.style.width = `calc(${width}% - 2px)`;
      row.appendChild(highlight);
    });

    calendarGrid.appendChild(row);
  });

  // Today line — wraps seamlessly around edge
  const todayLine = document.createElement("div");
  todayLine.className = "today-line";
  todayLine.style.left = `calc(${todayRatio * 100}% + 150px)`;
  calendarGrid.appendChild(todayLine);
}

// Buttons
document.getElementById("prevBtn").addEventListener("click", () => {
  currentMonthOffset = (currentMonthOffset - 1 + 12) % 12;
  renderCalendar(currentMonthOffset);
});
document.getElementById("nextBtn").addEventListener("click", () => {
  currentMonthOffset = (currentMonthOffset + 1) % 12;
  renderCalendar(currentMonthOffset);
});

// --- Touch swipe (mobile) ---
let touchStartX = 0;
let touchEndX = 0;
const swipeThreshold = 60;

calendarWrapper.addEventListener("touchstart", (e) => {
  touchStartX = e.changedTouches[0].screenX;
}, { passive: true });

calendarWrapper.addEventListener("touchmove", (e) => {
  touchEndX = e.changedTouches[0].screenX;
}, { passive: true });

calendarWrapper.addEventListener("touchend", () => {
  const deltaX = touchEndX - touchStartX;
  if (Math.abs(deltaX) > swipeThreshold) {
    if (deltaX < 0) currentMonthOffset = (currentMonthOffset + 1) % 12;
    else currentMonthOffset = (currentMonthOffset - 1 + 12) % 12;
    renderCalendar(currentMonthOffset);
  }
});

// --- Desktop click & drag scroll ---
let isDown = false;
let startX;
let scrollLeft;

calendarWrapper.addEventListener('mousedown', (e) => {
  isDown = true;
  calendarWrapper.classList.add('dragging');
  startX = e.pageX - calendarWrapper.offsetLeft;
  scrollLeft = calendarWrapper.scrollLeft;
});

calendarWrapper.addEventListener('mouseleave', () => {
  isDown = false;
  calendarWrapper.classList.remove('dragging');
});

calendarWrapper.addEventListener('mouseup', () => {
  isDown = false;
  calendarWrapper.classList.remove('dragging');
});

calendarWrapper.addEventListener('mousemove', (e) => {
  if (!isDown) return;
  e.preventDefault();
  const x = e.pageX - calendarWrapper.offsetLeft;
  const walk = (x - startX);
  calendarWrapper.scrollLeft = scrollLeft - walk;
});

// Initialize render
renderCalendar();
</script>

  <!-- Profession Feature Grid -->
  <section class="section">
    <div class="container grid cols-4">
      <a class="card lift feature-card finance" href="radar.html?profession=finance">
        <div class="title">Finance</div>
        <div class="meta">IB, S&T, AM timelines</div>
      </a>
      <a class="card lift feature-card accounting" href="radar.html?profession=accounting">
        <div class="title">Accounting</div>
        <div class="meta">Assurance & Tax cycles</div>
      </a>
      <a class="card lift feature-card consulting" href="radar.html?profession=consulting">
        <div class="title">Consulting</div>
        <div class="meta">Strategy & Ops recruiting</div>
      </a>
      <a class="card lift feature-card realestate" href="radar.html?profession=realestate">
        <div class="title">Real Estate</div>
        <div class="meta">Investment & Dev tracks</div>
      </a>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="container inner">
      <small>Built for students who think in data.</small>
      <small>© <span id="year"></span> Internalytics</small>
    </div>
  </footer>

  <!-- Minimal JS: JSON-driven CycleMap preview (MVP, static data) -->
  <script>
    // Example static JSON dataset for the preview (Phase 1 / MVP)
    const cycleData = [
      { role: "Finance — Bulge Bracket", phases: [
        { type: "open", start: 5, end: 25 },      // day-of-year percentages (0–100)
        { type: "interview", start: 26, end: 45 },
        { type: "offer", start: 46, end: 55 },
      ]},
      { role: "Accounting — Big 4", phases: [
        { type: "open", start: 10, end: 30 },
        { type: "interview", start: 34, end: 52 },
        { type: "offer", start: 58, end: 65 },
      ]},
      { role: "Consulting — MBB/Boutique", phases: [
        { type: "open", start: 15, end: 35 },
        { type: "interview", start: 40, end: 60 },
        { type: "offer", start: 64, end: 75 },
      ]},
      { role: "Real Estate — IM/Dev", phases: [
        { type: "open", start: 20, end: 38 },
        { type: "interview", start: 42, end: 58 },
        { type: "offer", start: 63, end: 72 },
      ]},
    ];

    const rowsHost = document.getElementById("cycle-rows");

    function renderCycleRows(data) {
      rowsHost.innerHTML = "";
      data.forEach(item => {
        const row = document.createElement("div");
        row.className = "row";
        const role = document.createElement("div");
        role.className = "role";
        role.textContent = item.role;
        const lane = document.createElement("div");
        lane.className = "lane";
        // add phases
        item.phases.forEach(p => {
          const el = document.createElement("div");
          el.className = "phase " + p.type;
          el.style.left = p.start + "%";
          el.style.width = (p.end - p.start) + "%";
          el.title = p.type.toUpperCase() + " • " + p.start + "%–" + p.end + "%";
          el.setAttribute("aria-label", el.title);
          lane.appendChild(el);
        });
        row.appendChild(role);
        row.appendChild(lane);
        rowsHost.appendChild(row);
      });
    }
    renderCycleRows(cycleData);

    // Year in footer
    document.getElementById("year").textContent = new Date().getFullYear();
  </script>
</body>
</html>
